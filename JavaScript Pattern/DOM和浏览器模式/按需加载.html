<!DOCTYPE html>
<html>
    <head></head>
<body>
<script type="text/javascript">
    function require(file, callback) {
        var script = document.getElementsByTagName('script')[0],
                newjs = document.createElement('script');

        // IE
        newjs.onreadystatechange = function() {
            if(newjs.readyState === 'load' || newjs.readyState === 'complete' ) {
                newjs.onreadystatechange = null;
                // 当js正确加载, newjs的状态会改变
                callback();
            }
        };

        // 其他
        newjs.onload = function () {
            callback();
        };

        newjs.src = file;
        script.parentNode.insertBefore(newjs, script);
    }

    // ---测试----
    require('ondemand.js.php', function(){
        extraFunction('loaded from the parent page');
        document.body.appendChild(document.createTextNode('done!'));
    });
</script>
</body>
</html>
