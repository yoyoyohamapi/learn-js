<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>采用定时器优化的大循环</title>
</head>
<body>
<table>
    <tbody></tbody>
</table>
<script type="text/javascript">
    var rowCount = 20000;
    var divideInto = 4;
    var chunkSize = rowCount / divideInto;
    var iteration = 0;

    var table = document.getElementsByTagName("table")[0];

    setTimeout(function generateRows() {
        var base = (chunkSize) * iteration;
        for (var i = 0; i < chunkSize; i++) {
            var tr = document.createElement("tr");

            for (var t = 0; t < 6; t++) {
                var td = document.createElement("td");
                td.appendChild(document.createTextNode((i + base) + ',' + t + "," + iteration));
                tr.appendChild(td);
            }
            table.appendChild(tr);
        }
        iteration++;
        if (iteration < divideInto) {
            setTimeout(generateRows, 10);
        }
    }, 0);


</script>
</body>
</html>